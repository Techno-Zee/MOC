<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Form view of the dashboard block -->
    <record id="dashboard_block_view_form" model="ir.ui.view">
        <field name="name">dashboard.block.view.form</field>
        <field name="model">dashboard.block</field>
        <field name="arch" type="xml">
            <form class="dashboard-block-form">
                <header>
                    <button name="action_refresh_data" string="Refresh Data" type="object" class="btn-secondary" icon="fa-refresh" />
                    <button name="action_duplicate_block" string="Duplicate" type="object" class="btn-secondary" icon="fa-copy" />
                    <button name="unlink" string="Delete" type="object" class="btn-danger" icon="fa-trash" confirm="Are you sure you want to delete this block?" />
                    <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-eye-slash" invisible="active == True" />
                    <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-eye" invisible="active == False" />
                    <field name="type" widget="statusbar" required="1" readonly="edit_mode == False" />
                </header>
                <sheet>
                    <!-- Header Section -->
                    <div class="oe_title">
                        <h1>
                            <field name="name" class="oe_inline" placeholder="Block Name" required="1" readonly="edit_mode == False" />
                        </h1>
                        <div>
                            <field name="type" required="1" />
                        </div>
                    </div>
                    <!-- Notebook with tabs -->
                    <notebook>
                        <!-- Tab 1: Basic Configuration -->
                        <page string="Configuration">
                            <group>
                                <group string="Data Source">
                                    <field name="model_id" required="1" options="{'no_create_edit':True,'no_create': True}" readonly="edit_mode == False" />
                                    <field name="model_name" invisible="1" />
                                    <field name="description" invisible="type == 'tile'" placeholder="Enter description..." />
                                </group>
                                <group string="Aggregation">
                                    <field name="operation" required="1" readonly="edit_mode == False" />
                                    <field name="measured_field_id" required="operation in ['sum','avg','min','max']" readonly="edit_mode == False" options="{'no_create_edit':True, 'no_create': True}" />
                                    <field name="filter" widget="domain" options="{'model': 'model_name'}" readonly="edit_mode == False" />
                                    <field name="group_by_id" invisible="type != 'graph'" readonly="edit_mode == False" />
                                </group>
                            </group>
                            <group string="Preview" invisible="type == 'graph'">
                                <field name="record_value" widget="monetary" options="{'currency_field': 'currency_id'}" readonly="1" class="oe_inline" />
                                <label string="Current Value" for="record_value" />
                                <div class="o_stat_info">
                                    <span class="o_stat_text">Target:</span>
                                    <field name="target_value" class="o_stat_value" />
                                </div>
                            </group>
                        </page>
                        <!-- Tab 2: Visual Settings -->
                        <page string="Visual">
                            <group>
                                <group string="Chart Settings" invisible="type != 'graph'">
                                    <field name="graph_type" required="1" readonly="edit_mode == False" />
                                    <label string="Group by field" for="group_by_id" />
                                    <field name="group_by_id" readonly="edit_mode == False" />
                                </group>
                                <group string="Tile/KPI Settings" invisible="not (type in ['tile','kpi'])">
                                    <field name="fa_icon" widget="icon_picker" placeholder="fa-chart-line" readonly="edit_mode == False" />
                                    <field name="icon_size" readonly="edit_mode == False" />
                                    <field name="show_trend" readonly="edit_mode == False" />
                                    <field name="trend_period" invisible="show_trend == False" readonly="edit_mode == False" />
                                </group>
                                <group string="Table Settings" invisible="type != 'list'">
                                    <field name="tag_fields_ids" widget="many2many_tags" readonly="edit_mode == False" />
                                    <field name="table_limit" readonly="edit_mode == False" />
                                    <field name="show_pagination" readonly="edit_mode == False" />
                                </group>
                            </group>
                            <group string="Color Scheme">
                                <field name="tile_color" widget="color" readonly="edit_mode == False" />
                                <field name="text_color" widget="color" readonly="edit_mode == False" />
                                <field name="val_color" widget="color" readonly="edit_mode == False" />
                                <field name="fa_color" widget="color" readonly="edit_mode == False" />
                            </group>
                        </page>
                        <!-- Tab 3: KPI/Target Settings -->
                        <page string="KPI Targets" invisible="type != 'kpi'">
                            <group>
                                <group string="Values">
                                    <field name="record_value" readonly="1" widget="monetary" options="{'currency_field': 'currency_id'}" />
                                    <field name="prev_value" readonly="edit_mode == False" />
                                    <field name="target_value" readonly="edit_mode == False" />
                                </group>
                                <group string="Trend Calculation">
                                    <field name="show_trend" readonly="edit_mode == False" />
                                    <field name="trend_period" invisible="show_trend == False" readonly="edit_mode == False" />
                                </group>
                            </group>
                        </page>
                        <!-- Tab 4: Layout Settings -->
                        <page string="Layout">
                            <group>
                                <group string="Grid Position">
                                    <field name="sequence" readonly="edit_mode == False" />
                                    <field name="data_x" readonly="edit_mode == False" />
                                    <field name="data_y" readonly="edit_mode == False" />
                                    <field name="grid_width" readonly="edit_mode == False" />
                                    <field name="grid_height" readonly="edit_mode == False" />
                                </group>
                                <group string="Dimensions">
                                    <field name="height" placeholder="300px" readonly="edit_mode == False" />
                                    <field name="width" placeholder="100%" readonly="edit_mode == False" />
                                </group>
                            </group>
                        </page>
                        <!-- Tab 5: Advanced -->
                        <page string="Advanced">
                            <group>
                                <field name="is_public" readonly="edit_mode == False" />
                                <field name="client_action_id" invisible="1" />
                                <field name="edit_mode" invisible="1" />
                                <field name="last_update" readonly="1" />
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>
    <!-- List view of the dashboard block -->
    <record id="dashboard_block_view_list" model="ir.ui.view">
        <field name="name">dashboard.block.view.list</field>
        <field name="model">dashboard.block</field>
        <field name="arch" type="xml">
            <list string="Dashboard Blocks" decoration-muted="active==False">
                <field name="sequence" widget="handle" />
                <field name="name" />
                <field name="model_id" />
                <field name="type" widget="badge" decoration-info="type=='graph'" decoration-success="type=='tile'" decoration-warning="type=='list'" />
                <field name="record_value" widget="progressbar" options="{'editable': false, 'max_value': 100}" />
                <field name="active" invisible="1" />
                <field name="is_public" widget="boolean_button" options="{'terminology': 'active'}" />
                <field name="last_update" />
            </list>
        </field>
    </record>
    <!-- Search view -->
    <record id="dashboard_block_view_search" model="ir.ui.view">
        <field name="name">dashboard.block.view.search</field>
        <field name="model">dashboard.block</field>
        <field name="arch" type="xml">
            <search>
                <field name="name" />
                <field name="model_id" />
                <field name="type" />
                <filter name="active" string="Active" domain="[('active','=',True)]" />
                <filter name="inactive" string="Inactive" domain="[('active','=',False)]" />
                <filter name="graphs" string="Graphs" domain="[('type','=','graph')]" />
                <filter name="tiles" string="Tiles" domain="[('type','=','tile')]" />
                <filter name="tables" string="Tables" domain="[('type','=','list')]" />
                <filter name="public" string="Public" domain="[('is_public','=',True)]" />
                <separator />
                <group string="Group By" expand="0">
                    <filter name="group_type" string="Type" context="{'group_by': 'type'}" />
                    <filter name="group_model" string="Model" context="{'group_by': 'model_id'}" />
                    <filter name="group_active" string="Active" context="{'group_by': 'active'}" />
                </group>
            </search>
        </field>
    </record>
    <!-- Kanban view (optional) -->
    <record id="dashboard_block_view_kanban" model="ir.ui.view">
        <field name="name">dashboard.block.view.kanban</field>
        <field name="model">dashboard.block</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile">
                <field name="name" />
                <field name="type" />
                <field name="record_value" />
                <field name="tile_color" />
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_global_click">
                            <div class="o_kanban_record_top">
                                <div class="o_kanban_record_header">
                                    <strong>
                                        <field name="name" />
                                    </strong>
                                    <div t-attf-class="label label-primary o_kanban_record_title">
                                        <field name="type" />
                                    </div>
                                </div>
                            </div>
                            <div class="o_kanban_record_body">
                                <div class="o_kanban_record_content">
                                    <field name="record_value" widget="monetary" />
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>
    <!-- Action specified for the dashboard block -->
    <record id="dashboard_block_action" model="ir.actions.act_window">
        <field name="name">Dashboard Blocks</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">dashboard.block</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="search_view_id" ref="dashboard_block_view_search" />
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">Create your first dashboard block!</p>
            <p>Dashboard blocks allow you to visualize data from any Odoo model.
                You can create charts, tiles, tables, and KPI indicators.</p>
        </field>
    </record>
</odoo>